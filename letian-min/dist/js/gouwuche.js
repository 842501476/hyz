"use strict";$(function(){function t(n){var a=n.parents("td").prev().find(".deals").text(),t=((a=1*a.slice(1))*(1*n.parent().find("input").val())).toFixed(2);n.parents("td").next().find(".deals").html(t),c()}function i(){0==$("#gws").size()&&($("#gww0").css("display","none"),$("#gwwp").css("display","block"))}$("#logout").on("click",function(){window.location.href="../index.html",$.removeCookie("name",{path:"/"}),i()}),$.ajax({type:"post",url:"../api/gouwuche.php",async:!0,data:{a:"gwcxr"},success:function(n){var a=JSON.parse(n).map(function(n){return'<tr class="prdBoundary"  id=\''+n.goodid+'\'>\n                <td class="alL verT pl20">\n                    <div class="checkboxGroup point">\n                        <input id="'+(n.goodid+4)+'" name="check" type="checkbox" value="1" class=\'cbx\'>\n                        <label for="'+(n.goodid+4)+'" class="hide"><span></span></label>\n                    </div>\n                </td>\n                <td class="verT">\n                    <div class="productItem">\n\n                        <div class="img">\n                            <a href="###">\n                                <img src="../images/'+n.img+'">\n                            </a>\n                        </div>\n                        <div class="info">\n                            <div class="flagArea mb9">\n                                '+n.biaoqian+'\n                            </div>\n                            <a href="">\n                                <div class="brand"><strong>'+n.goodname+"</strong>"+n.goodname2+'</div>\n                                <div class="product">'+n.title+'</div>\n                                <div class="code">'+n.daima+'</div>\n                            </a>\n                            <div class="etcTxt"><strong>不可用</strong><i>购物车优惠券</i></div>\n                            <div class="optionArea">\n                            </div>\n                        </div>\n                    </div>\n                </td>\n                <td>\n                    <div class="priceArea">\n                        <div class="price cancel">$'+n.oldprice+'</div>\n                        <div class="deals">$'+n.newprice+'</div>\n                        <div class="discount">\n                            <span>'+n.dazhe+'</span>\n                            <div class="tooltipWrap">\n                                <a href="javascript:void(0);" class="btnTip"></a>\n                                <div class="contTip" style="display: none; top: -162px; left: -166px;">\n                                    <div class="dcCont">\n                                        <div class="tableArea tableIner alC">\n                                            <h4 class="smTitle">折扣优惠</h4>\n                                            <div class="tableBox">\n                                                <table>\n                                                    <caption>折扣优惠</caption>\n                                                    <thead>\n                                                        <tr>\n                                                            <th scope="col">项目</th>\n                                                            <th scope="col">优惠率</th>\n                                                            <th scope="col">优惠金额</th>\n                                                        </tr>\n                                                    </thead>\n                                                    <tbody>\n                                                        <tr>\n                                                            <td>会员优惠<br>(普通)</td>\n                                                            <td><span class="fcf1">9.5折</span></td>\n                                                            <td>\n                                                                $7.45\n                                                                <br>约50.59元\n                                                            </td>\n                                                        </tr>\n                                                    </tbody>\n                                                </table>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <a href="javascript:void(0);" class="btnClose"></a>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </td>\n                <td>\n                    <div class="eaModify disIb">\n                        <div class="form">\n\n\n                        <a href="javascript:void(0)" class="up btnUp" title="" id=\'gwx\'></a>\n                        <input type="text" name="ordQty" title="" value="'+n.goodnum+'" class=\'gdnum\'>\n                        <a href="javascript:void(0)" class="down btnDown" title="" id=\'gws\'></a>\n\n\n                        </div>\n                        <a href="#none" class="modify btnModify">修改</a>\n                    </div>\n                </td>\n                <td>\n                    <div class="priceArea">\n                    <span class=\'meiyuan\' style=\'font-weight:bold;color:red;\'>$</span>\n                        <span class="deals djzj">'+(n.newprice*n.goodnum).toFixed(2)+'</span>\n                        <div class="other">(约'+12*(n.newprice*n.goodnum).toFixed(2)+'.00元)</div>\n                    </div>\n                </td>\n                <td class="btnCell pr20 alR">\n                    <div class="btnPrdArea">\n                        <a href="javascript:void(0);" class="btn4 rline btnBuynow">立即购买</a>\n                        <div class="tooltipPrd">\n                            <a href="javascript:void(0);" class="btn4 bline btnContinue">保留在购物车</a>\n                        </div>\n                        <a href="###" class="btn4 aline btnDelete">删除</a>\n                    </div>\n                </td>\n            </tr>'}).join("");$("#gwlb").html(a),i()}}),$("#gwlb").on("click","#gws",function(){var n=$(this).prev().val();--n<=1&&(n=1),$(this).prev().val(n),t($(this));var a=$(this).parents("tr").attr("id");$.ajax({type:"post",url:"../api/gouwuche.php",async:!0,data:{a:"gwcj",goodnum:n,goodid:a},success:function(n){}})}),$("#gwlb").on("click","#gwx",function(){var n=$(this).next().val();10<=++n&&(n=10),$(this).next().val(n),t($(this));var a=$(this).parents("tr").attr("id");$.ajax({type:"post",url:"../api/gouwuche.php",async:!0,data:{a:"gwcz",goodnum:n,goodid:a},success:function(n){}})}),$("#gwlb").on("click",".btnDelete",function(){if(confirm("您确定要删除吗？")){$(this).parents("tr").remove(),i(),c();var n=$(this).parents("tr").attr("id");$.ajax({type:"post",url:"../api/gouwuche.php",async:!0,data:{a:"gwcsc",goodid:n},success:function(n){}})}}),$("#bigg").on("click",".checkboxGroup input",function(){c()}),$("#check_all").on("click",function(){$(this).prop("checked")?$(".checkboxGroup input").prop("checked","checked"):$(".checkboxGroup input").removeAttr("checked"),c()});var s=[];function c(){s=[];for(var n=0;n<$(".cbx").size();n++)$(".cbx").eq(n).prop("checked")&&s.push(n);s.length==$(".cbx").size()?$("#check_all").prop("checked","checked"):$("#check_all").removeAttr("checked");var a=0,t=0;for(n=0;n<s.length;n++)t+=1*$(".gdnum").eq(s[n]).val(),a+=1*$(".djzj").eq(s[n]).text();$("#allnum").html(t+" 件商品"),$("#totalprice").html("$"+a.toFixed(2))}$("#gwlb").on("input",".gdnum",function(){if($(this).val()<=10){t($(this)),c();var n=$(this).val(),a=$(this).parents("tr").attr("id");$.ajax({type:"post",url:"../api/gouwuche.php",async:!0,data:{a:"gwcsr",goodnum:n,goodid:a},success:function(n){}})}else alert("最多可购买10件!"),$(this).val("10")}),$("#dellall").on("click",function(){if(confirm("您确定要清空购物车吗？"))for(var n=s.length-1;0<=n;n--)$("#gwlb .prdBoundary").eq(s[n]).remove(),i(),c(),$.ajax({type:"post",url:"../api/gouwuche.php",async:!0,data:{a:"gwcqs"},success:function(n){}})})});